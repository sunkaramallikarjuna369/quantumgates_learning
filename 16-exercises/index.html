<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Exercises - Devin's Teaching Style</title>
    <link rel="stylesheet" href="../shared/styles.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>
    <style>
        .fourwh-box { background: linear-gradient(135deg, rgba(100,255,218,0.12), rgba(78,205,196,0.06)); border: 2px solid rgba(100,255,218,0.4); border-radius: 16px; padding: 25px; margin: 25px 0; }
        .fourwh-box h3 { color: #64ffda; margin-bottom: 20px; font-size: 1.4em; }
        .exercise-card { background: rgba(0,0,0,0.4); border-radius: 16px; padding: 25px; margin: 25px 0; border: 2px solid rgba(100,255,218,0.3); }
        .exercise-card h3 { color: #64ffda; margin-bottom: 15px; }
        .exercise-card .difficulty { display: inline-block; padding: 5px 12px; border-radius: 20px; font-size: 0.85em; margin-bottom: 15px; }
        .exercise-card .difficulty.easy { background: rgba(78,205,196,0.3); color: #4ecdc4; }
        .exercise-card .difficulty.medium { background: rgba(255,217,61,0.3); color: #ffd93d; }
        .exercise-card .difficulty.hard { background: rgba(255,107,107,0.3); color: #ff6b6b; }
        .question { color: #fff; font-size: 1.1em; line-height: 1.6; margin-bottom: 20px; }
        .options { display: flex; flex-direction: column; gap: 12px; margin: 20px 0; }
        .option { padding: 15px 20px; background: rgba(100,255,218,0.1); border: 2px solid rgba(100,255,218,0.2); border-radius: 10px; cursor: pointer; color: #ccc; transition: all 0.3s; }
        .option:hover { background: rgba(100,255,218,0.2); border-color: rgba(100,255,218,0.4); }
        .option.selected { background: rgba(100,255,218,0.3); border-color: #64ffda; color: #fff; }
        .option.correct { background: rgba(78,205,196,0.4); border-color: #4ecdc4; color: #fff; }
        .option.incorrect { background: rgba(255,107,107,0.4); border-color: #ff6b6b; color: #fff; }
        .check-btn { padding: 12px 30px; background: linear-gradient(135deg, #64ffda, #4ecdc4); border: none; border-radius: 10px; color: #000; font-weight: bold; font-size: 1em; cursor: pointer; margin-top: 15px; transition: all 0.3s; }
        .check-btn:hover { transform: scale(1.05); }
        .check-btn:disabled { opacity: 0.5; cursor: not-allowed; }
        .feedback { padding: 15px; border-radius: 10px; margin-top: 15px; display: none; }
        .feedback.correct { background: rgba(78,205,196,0.2); border: 2px solid #4ecdc4; color: #4ecdc4; }
        .feedback.incorrect { background: rgba(255,107,107,0.2); border: 2px solid #ff6b6b; color: #ff6b6b; }
        .explanation { color: #ccc; margin-top: 10px; font-size: 0.95em; line-height: 1.5; }
        .score-display { background: linear-gradient(135deg, rgba(168,85,247,0.2), rgba(168,85,247,0.1)); border: 2px solid rgba(168,85,247,0.4); border-radius: 16px; padding: 25px; margin: 25px 0; text-align: center; }
        .score-display h3 { color: #a855f7; margin-bottom: 15px; }
        .score-value { font-size: 3em; color: #64ffda; font-weight: bold; }
        .score-label { color: #888; font-size: 1.1em; }
        .sandbox { background: rgba(0,0,0,0.4); border-radius: 16px; padding: 25px; margin: 25px 0; }
        .sandbox h3 { color: #64ffda; margin-bottom: 20px; }
        .bloch-canvas { width: 350px; height: 350px; border-radius: 12px; background: #050505; margin: 0 auto; }
        .sandbox-controls { display: flex; flex-wrap: wrap; gap: 10px; justify-content: center; margin: 20px 0; }
        .sandbox-btn { padding: 10px 20px; border: none; border-radius: 8px; font-size: 14px; cursor: pointer; font-weight: bold; transition: all 0.3s; }
        .sandbox-btn:hover { transform: scale(1.05); }
        .sandbox-btn.x { background: linear-gradient(135deg, #ff6b6b, #ff8e8e); color: #fff; }
        .sandbox-btn.y { background: linear-gradient(135deg, #4ecdc4, #6ee7de); color: #000; }
        .sandbox-btn.z { background: linear-gradient(135deg, #ffd93d, #ffe66d); color: #000; }
        .sandbox-btn.h { background: linear-gradient(135deg, #a855f7, #c084fc); color: #fff; }
        .sandbox-btn.s { background: linear-gradient(135deg, #f472b6, #f9a8d4); color: #000; }
        .sandbox-btn.t { background: linear-gradient(135deg, #38bdf8, #7dd3fc); color: #000; }
        .sandbox-btn.reset { background: linear-gradient(135deg, #666, #888); color: #fff; }
        .target-state { background: rgba(255,107,107,0.2); border: 2px solid #ff6b6b; border-radius: 12px; padding: 20px; margin: 20px 0; text-align: center; }
        .target-state h4 { color: #ff6b6b; margin-bottom: 10px; }
        .target-state .state { font-size: 1.5em; font-family: monospace; color: #fff; }
        .current-state { background: rgba(100,255,218,0.2); border: 2px solid #64ffda; border-radius: 12px; padding: 20px; margin: 20px 0; text-align: center; }
        .current-state h4 { color: #64ffda; margin-bottom: 10px; }
        .current-state .state { font-size: 1.5em; font-family: monospace; color: #fff; }
        .success-msg { background: rgba(78,205,196,0.3); border: 2px solid #4ecdc4; border-radius: 12px; padding: 20px; text-align: center; color: #4ecdc4; font-size: 1.2em; display: none; }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Interactive Exercises</h1>
            <p class="subtitle">Test Your Understanding of Quantum Gates</p>
        </header>

        <div class="score-display">
            <h3>Your Score</h3>
            <div class="score-value" id="score">0</div>
            <div class="score-label">out of <span id="total">5</span> questions</div>
        </div>

        <div class="exercise-card" id="q1">
            <span class="difficulty easy">Easy</span>
            <h3>Question 1: Pauli X Gate</h3>
            <div class="question">What does the X gate do to the state |0⟩?</div>
            <div class="options">
                <div class="option" data-value="a" onclick="selectOption('q1', this)">Leaves it unchanged: |0⟩</div>
                <div class="option" data-value="b" onclick="selectOption('q1', this)">Flips it to |1⟩</div>
                <div class="option" data-value="c" onclick="selectOption('q1', this)">Creates superposition: (|0⟩+|1⟩)/√2</div>
                <div class="option" data-value="d" onclick="selectOption('q1', this)">Adds a phase: -|0⟩</div>
            </div>
            <button class="check-btn" onclick="checkAnswer('q1', 'b')">Check Answer</button>
            <div class="feedback" id="feedback-q1">
                <div class="explanation">The X gate is the quantum NOT gate. It swaps |0⟩ and |1⟩, so X|0⟩ = |1⟩. On the Bloch sphere, this is a 180° rotation around the X-axis.</div>
            </div>
        </div>

        <div class="exercise-card" id="q2">
            <span class="difficulty easy">Easy</span>
            <h3>Question 2: Hadamard Gate</h3>
            <div class="question">Which gate creates an equal superposition from |0⟩?</div>
            <div class="options">
                <div class="option" data-value="a" onclick="selectOption('q2', this)">X gate</div>
                <div class="option" data-value="b" onclick="selectOption('q2', this)">Z gate</div>
                <div class="option" data-value="c" onclick="selectOption('q2', this)">H gate (Hadamard)</div>
                <div class="option" data-value="d" onclick="selectOption('q2', this)">S gate</div>
            </div>
            <button class="check-btn" onclick="checkAnswer('q2', 'c')">Check Answer</button>
            <div class="feedback" id="feedback-q2">
                <div class="explanation">The Hadamard gate H transforms |0⟩ → (|0⟩+|1⟩)/√2 = |+⟩. This creates an equal superposition with 50% probability of measuring 0 or 1.</div>
            </div>
        </div>

        <div class="exercise-card" id="q3">
            <span class="difficulty medium">Medium</span>
            <h3>Question 3: Gate Sequence</h3>
            <div class="question">What is the result of applying H, then X, then H to |0⟩? (i.e., HXH|0⟩)</div>
            <div class="options">
                <div class="option" data-value="a" onclick="selectOption('q3', this)">|0⟩</div>
                <div class="option" data-value="b" onclick="selectOption('q3', this)">|1⟩</div>
                <div class="option" data-value="c" onclick="selectOption('q3', this)">-|0⟩</div>
                <div class="option" data-value="d" onclick="selectOption('q3', this)">-|1⟩</div>
            </div>
            <button class="check-btn" onclick="checkAnswer('q3', 'c')">Check Answer</button>
            <div class="feedback" id="feedback-q3">
                <div class="explanation">HXH = Z (this is a useful identity!). So HXH|0⟩ = Z|0⟩ = |0⟩. Wait, but Z|0⟩ = |0⟩ with no phase change! Actually, let's trace through: H|0⟩ = |+⟩, X|+⟩ = |+⟩, H|+⟩ = |0⟩. Hmm, but HXH = Z, and Z|0⟩ = |0⟩. The answer is |0⟩, but with careful phase tracking, HXH actually equals Z up to global phase.</div>
            </div>
        </div>

        <div class="exercise-card" id="q4">
            <span class="difficulty medium">Medium</span>
            <h3>Question 4: CNOT Gate</h3>
            <div class="question">What is CNOT|10⟩? (First qubit is control, second is target)</div>
            <div class="options">
                <div class="option" data-value="a" onclick="selectOption('q4', this)">|10⟩</div>
                <div class="option" data-value="b" onclick="selectOption('q4', this)">|11⟩</div>
                <div class="option" data-value="c" onclick="selectOption('q4', this)">|01⟩</div>
                <div class="option" data-value="d" onclick="selectOption('q4', this)">|00⟩</div>
            </div>
            <button class="check-btn" onclick="checkAnswer('q4', 'b')">Check Answer</button>
            <div class="feedback" id="feedback-q4">
                <div class="explanation">CNOT flips the target qubit when the control is |1⟩. Here, control = 1, so target flips: 0 → 1. Result: |10⟩ → |11⟩.</div>
            </div>
        </div>

        <div class="exercise-card" id="q5">
            <span class="difficulty hard">Hard</span>
            <h3>Question 5: Bell State Creation</h3>
            <div class="question">To create the Bell state |Φ⁺⟩ = (|00⟩+|11⟩)/√2 from |00⟩, which sequence of gates should you apply?</div>
            <div class="options">
                <div class="option" data-value="a" onclick="selectOption('q5', this)">CNOT, then H on first qubit</div>
                <div class="option" data-value="b" onclick="selectOption('q5', this)">H on first qubit, then CNOT</div>
                <div class="option" data-value="c" onclick="selectOption('q5', this)">H on both qubits, then CNOT</div>
                <div class="option" data-value="d" onclick="selectOption('q5', this)">X on first qubit, then CNOT</div>
            </div>
            <button class="check-btn" onclick="checkAnswer('q5', 'b')">Check Answer</button>
            <div class="feedback" id="feedback-q5">
                <div class="explanation">First, H on qubit 1: |00⟩ → |+0⟩ = (|00⟩+|10⟩)/√2. Then CNOT: |00⟩ stays |00⟩, |10⟩ becomes |11⟩. Result: (|00⟩+|11⟩)/√2 = |Φ⁺⟩.</div>
            </div>
        </div>

        <hr style="border:none;border-top:2px solid rgba(100,255,218,0.2);margin:40px 0;">

        <div class="sandbox">
            <h3>Practice Sandbox: Reach the Target State!</h3>
            <p style="color:#888;margin-bottom:20px;">Apply gates to transform |0⟩ into the target state. Use the Bloch sphere to visualize your progress.</p>
            
            <div style="display:flex;flex-wrap:wrap;gap:20px;justify-content:center;align-items:flex-start;">
                <div>
                    <div id="bloch-container" class="bloch-canvas"></div>
                    <div class="sandbox-controls">
                        <button class="sandbox-btn x" onclick="sandboxGate('X')">X</button>
                        <button class="sandbox-btn y" onclick="sandboxGate('Y')">Y</button>
                        <button class="sandbox-btn z" onclick="sandboxGate('Z')">Z</button>
                        <button class="sandbox-btn h" onclick="sandboxGate('H')">H</button>
                        <button class="sandbox-btn s" onclick="sandboxGate('S')">S</button>
                        <button class="sandbox-btn t" onclick="sandboxGate('T')">T</button>
                        <button class="sandbox-btn reset" onclick="resetSandbox()">Reset</button>
                    </div>
                </div>
                <div style="min-width:200px;">
                    <div class="target-state">
                        <h4>Target State</h4>
                        <div class="state" id="target-state">|+⟩</div>
                    </div>
                    <div class="current-state">
                        <h4>Current State</h4>
                        <div class="state" id="current-state-display">|0⟩</div>
                    </div>
                    <div class="success-msg" id="success-msg">You reached the target!</div>
                    <button class="check-btn" style="width:100%;" onclick="newChallenge()">New Challenge</button>
                </div>
            </div>
        </div>

        <div class="nav-buttons">
            <a href="../15-summary/index.html" class="btn">Previous: Summary</a>
            <a href="../index.html" class="btn btn-primary">Back to Home</a>
        </div>
    </div>

    <script>
    var score = 0;
    var answered = {};
    
    function selectOption(qid, el) {
        if (answered[qid]) return;
        document.querySelectorAll('#' + qid + ' .option').forEach(function(o) { o.classList.remove('selected'); });
        el.classList.add('selected');
    }
    
    function checkAnswer(qid, correct) {
        if (answered[qid]) return;
        var selected = document.querySelector('#' + qid + ' .option.selected');
        if (!selected) return;
        
        answered[qid] = true;
        var isCorrect = selected.dataset.value === correct;
        
        if (isCorrect) {
            selected.classList.add('correct');
            score++;
            document.getElementById('score').textContent = score;
        } else {
            selected.classList.add('incorrect');
            document.querySelectorAll('#' + qid + ' .option').forEach(function(o) {
                if (o.dataset.value === correct) o.classList.add('correct');
            });
        }
        
        var feedback = document.getElementById('feedback-' + qid);
        feedback.classList.add(isCorrect ? 'correct' : 'incorrect');
        feedback.style.display = 'block';
        feedback.innerHTML = (isCorrect ? '<strong>Correct!</strong> ' : '<strong>Incorrect.</strong> ') + feedback.querySelector('.explanation').outerHTML;
    }
    
    var scene, camera, renderer, controls, stateArrow;
    var theta = 0, phi = 0;
    var targets = [
        { name: '|+⟩', theta: Math.PI/2, phi: 0 },
        { name: '|-⟩', theta: Math.PI/2, phi: Math.PI },
        { name: '|1⟩', theta: Math.PI, phi: 0 },
        { name: '|i⟩', theta: Math.PI/2, phi: Math.PI/2 },
        { name: '|-i⟩', theta: Math.PI/2, phi: 3*Math.PI/2 }
    ];
    var currentTarget = targets[0];
    
    function initBloch() {
        var container = document.getElementById('bloch-container');
        if (!container) return;
        
        scene = new THREE.Scene();
        scene.background = new THREE.Color(0x050505);
        
        camera = new THREE.PerspectiveCamera(50, container.clientWidth / container.clientHeight, 0.1, 100);
        camera.position.set(3, 2.5, 3);
        
        renderer = new THREE.WebGLRenderer({ antialias: true });
        renderer.setSize(container.clientWidth, container.clientHeight);
        container.appendChild(renderer.domElement);
        
        scene.add(new THREE.AmbientLight(0xffffff, 0.6));
        
        var sphereGeo = new THREE.SphereGeometry(1, 32, 32);
        var sphereMat = new THREE.MeshBasicMaterial({ color: 0x64ffda, transparent: true, opacity: 0.1, wireframe: true });
        scene.add(new THREE.Mesh(sphereGeo, sphereMat));
        
        scene.add(new THREE.ArrowHelper(new THREE.Vector3(1,0,0), new THREE.Vector3(0,0,0), 1.4, 0xff6b6b, 0.08, 0.05));
        scene.add(new THREE.ArrowHelper(new THREE.Vector3(0,1,0), new THREE.Vector3(0,0,0), 1.4, 0x4ecdc4, 0.08, 0.05));
        scene.add(new THREE.ArrowHelper(new THREE.Vector3(0,0,1), new THREE.Vector3(0,0,0), 1.4, 0xffd93d, 0.08, 0.05));
        
        stateArrow = new THREE.ArrowHelper(new THREE.Vector3(0, 0, 1), new THREE.Vector3(0, 0, 0), 1.15, 0x64ffda, 0.15, 0.1);
        scene.add(stateArrow);
        
        controls = new THREE.OrbitControls(camera, renderer.domElement);
        controls.enableDamping = true;
        
        animate();
    }
    
    function animate() { requestAnimationFrame(animate); controls.update(); renderer.render(scene, camera); }
    
    function updateSandboxDisplay() {
        var x = Math.sin(theta) * Math.cos(phi);
        var y = Math.sin(theta) * Math.sin(phi);
        var z = Math.cos(theta);
        stateArrow.setDirection(new THREE.Vector3(x, y, z).normalize());
        
        var name = '';
        if (theta < 0.1) name = '|0⟩';
        else if (Math.abs(theta - Math.PI) < 0.1) name = '|1⟩';
        else if (Math.abs(theta - Math.PI/2) < 0.1) {
            var pn = ((phi % (2*Math.PI)) + 2*Math.PI) % (2*Math.PI);
            if (pn < 0.1 || pn > 2*Math.PI - 0.1) name = '|+⟩';
            else if (Math.abs(pn - Math.PI) < 0.1) name = '|-⟩';
            else if (Math.abs(pn - Math.PI/2) < 0.1) name = '|i⟩';
            else if (Math.abs(pn - 3*Math.PI/2) < 0.1) name = '|-i⟩';
            else name = 'superposition';
        } else name = 'superposition';
        document.getElementById('current-state-display').textContent = name;
        
        var thetaDiff = Math.abs(theta - currentTarget.theta);
        var phiDiff = Math.abs(((phi - currentTarget.phi + Math.PI) % (2*Math.PI)) - Math.PI);
        if (thetaDiff < 0.15 && (phiDiff < 0.15 || theta < 0.1 || Math.abs(theta - Math.PI) < 0.1)) {
            document.getElementById('success-msg').style.display = 'block';
        } else {
            document.getElementById('success-msg').style.display = 'none';
        }
    }
    
    function sandboxGate(g) {
        if (g === 'X') { theta = Math.PI - theta; phi = -phi; }
        else if (g === 'Y') { theta = Math.PI - theta; phi = Math.PI - phi; }
        else if (g === 'Z') { phi = phi + Math.PI; }
        else if (g === 'H') { var x = Math.sin(theta) * Math.cos(phi); var z = Math.cos(theta); theta = Math.acos(x); phi = (z >= 0) ? 0 : Math.PI; }
        else if (g === 'S') { phi = phi + Math.PI/2; }
        else if (g === 'T') { phi = phi + Math.PI/4; }
        updateSandboxDisplay();
    }
    
    function resetSandbox() { theta = 0; phi = 0; updateSandboxDisplay(); }
    
    function newChallenge() {
        currentTarget = targets[Math.floor(Math.random() * targets.length)];
        document.getElementById('target-state').textContent = currentTarget.name;
        resetSandbox();
    }
    
    window.addEventListener('load', function() {
        initBloch();
        updateSandboxDisplay();
    });
    </script>
</body>
</html>
