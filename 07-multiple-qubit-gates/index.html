<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Multiple-Qubit Gates - Quantum Gates Learning</title>
    <link rel="stylesheet" href="../shared/styles.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>
    <style>
        .prereq-box { background: linear-gradient(135deg, rgba(100,255,218,0.1), rgba(78,205,196,0.05)); border: 2px solid rgba(100,255,218,0.3); border-radius: 16px; padding: 25px; margin: 20px 0; }
        .prereq-box h3 { color: #64ffda; margin-bottom: 15px; }
        .prereq-item { background: rgba(0,0,0,0.3); border-radius: 10px; padding: 15px; margin: 12px 0; border-left: 4px solid #64ffda; }
        .prereq-item h4 { color: #4ecdc4; margin-bottom: 8px; }
        .tensor-visual { display: flex; align-items: center; justify-content: center; gap: 15px; padding: 25px; background: rgba(0,0,0,0.3); border-radius: 12px; margin: 15px 0; flex-wrap: wrap; }
        .matrix-box { display: inline-grid; gap: 2px; background: rgba(0,0,0,0.4); padding: 8px; border-radius: 6px; border: 1px solid rgba(100,255,218,0.3); }
        .matrix-2x2 { grid-template-columns: repeat(2, 40px); }
        .matrix-4x4 { grid-template-columns: repeat(4, 35px); }
        .matrix-box .cell { height: 28px; display: flex; align-items: center; justify-content: center; background: rgba(100,255,218,0.15); color: #fff; font-size: 12px; border-radius: 3px; }
        .matrix-2x2 .cell { width: 40px; }
        .matrix-4x4 .cell { width: 35px; font-size: 11px; }
        .op-symbol { font-size: 24px; color: #64ffda; font-weight: bold; }
        .dual-bloch { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px; margin: 20px 0; }
        .bloch-panel { background: rgba(100,255,218,0.05); border: 1px solid rgba(100,255,218,0.2); border-radius: 12px; padding: 15px; }
        .bloch-panel h4 { color: #64ffda; text-align: center; margin-bottom: 10px; }
        .mini-bloch { width: 100%; height: 200px; border-radius: 8px; background: #050505; }
        .state-label { text-align: center; margin-top: 10px; font-family: monospace; color: #fff; }
        .basis-states { display: grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap: 10px; margin: 20px 0; }
        .basis-state { background: rgba(100,255,218,0.08); border: 1px solid rgba(100,255,218,0.2); border-radius: 8px; padding: 15px; text-align: center; }
        .basis-state .ket { font-size: 20px; color: #64ffda; font-family: monospace; }
        .basis-state .binary { font-size: 14px; color: #888; margin-top: 5px; }
        .basis-state .vector { font-size: 11px; color: #4ecdc4; margin-top: 5px; }
        .interactive-section { background: linear-gradient(135deg, rgba(100,255,218,0.08), rgba(78,205,196,0.03)); border: 2px solid rgba(100,255,218,0.3); border-radius: 16px; padding: 25px; margin: 25px 0; }
        .qubit-controls { display: flex; justify-content: center; gap: 40px; margin-bottom: 20px; flex-wrap: wrap; }
        .qubit-control { text-align: center; }
        .qubit-control h4 { color: #64ffda; margin-bottom: 10px; }
        .toggle-btns { display: flex; gap: 5px; }
        .toggle-btn { padding: 8px 16px; border: none; border-radius: 6px; cursor: pointer; font-weight: bold; transition: all 0.3s; }
        .toggle-btn.active { background: linear-gradient(135deg, #64ffda, #4ecdc4); color: #000; }
        .toggle-btn:not(.active) { background: rgba(100,255,218,0.2); color: #64ffda; }
        .combined-state { text-align: center; font-size: 24px; color: #fff; margin: 20px 0; font-family: monospace; padding: 20px; background: rgba(0,0,0,0.3); border-radius: 12px; }
        .amp-display { display: flex; justify-content: center; gap: 15px; flex-wrap: wrap; margin-top: 20px; }
        .amp-item { text-align: center; padding: 10px; background: rgba(0,0,0,0.3); border-radius: 8px; min-width: 70px; }
        .amp-item .ket { font-size: 14px; color: #64ffda; font-family: monospace; }
        .amp-item .bar { width: 50px; height: 60px; background: rgba(255,255,255,0.1); border-radius: 4px; margin: 8px auto; position: relative; overflow: hidden; }
        .amp-item .fill { position: absolute; bottom: 0; width: 100%; background: linear-gradient(to top, #64ffda, #4ecdc4); transition: height 0.3s; }
        .amp-item .val { font-size: 11px; color: #888; }
        .decision-guide { background: rgba(255,215,0,0.1); border: 1px solid rgba(255,215,0,0.3); border-radius: 12px; padding: 20px; margin: 20px 0; }
        .decision-guide h3 { color: #ffd93d; margin-bottom: 15px; }
        .decision-item { display: flex; align-items: flex-start; gap: 15px; padding: 12px; background: rgba(0,0,0,0.2); border-radius: 8px; margin: 10px 0; }
        .decision-item .goal { color: #4ecdc4; font-weight: bold; min-width: 200px; }
        .decision-item .solution { color: #fff; }
        .decision-item .gate { color: #ff6b6b; font-weight: bold; }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Multiple-Qubit Gates</h1>
            <p class="subtitle">Tensor Products and Multi-Qubit State Spaces</p>
        </header>

        <section class="section">
            <div class="prereq-box">
                <h3>Prerequisites</h3>
                <div class="prereq-item">
                    <h4>1. Single-Qubit States</h4>
                    <p>Each qubit has a 2D state space: |ψ⟩ = α|0⟩ + β|1⟩. When we combine qubits, the state space grows exponentially!</p>
                </div>
                <div class="prereq-item">
                    <h4>2. Tensor Product (⊗)</h4>
                    <p>The tensor product combines state spaces. For 2 qubits: |ψ₁⟩ ⊗ |ψ₂⟩ creates a 4D space with basis {|00⟩, |01⟩, |10⟩, |11⟩}.</p>
                </div>
                <div class="prereq-item">
                    <h4>3. Matrix Dimensions</h4>
                    <p>n qubits → 2ⁿ dimensional state space → 2ⁿ × 2ⁿ gate matrices. 2 qubits = 4×4 matrices, 3 qubits = 8×8 matrices.</p>
                </div>
            </div>
        </section>

        <section class="section">
            <h2>Two-Qubit Basis States</h2>
            <p>With 2 qubits, we have 4 computational basis states:</p>
            <div class="basis-states">
                <div class="basis-state">
                    <div class="ket">|00⟩</div>
                    <div class="binary">Binary: 0</div>
                    <div class="vector">[1,0,0,0]ᵀ</div>
                </div>
                <div class="basis-state">
                    <div class="ket">|01⟩</div>
                    <div class="binary">Binary: 1</div>
                    <div class="vector">[0,1,0,0]ᵀ</div>
                </div>
                <div class="basis-state">
                    <div class="ket">|10⟩</div>
                    <div class="binary">Binary: 2</div>
                    <div class="vector">[0,0,1,0]ᵀ</div>
                </div>
                <div class="basis-state">
                    <div class="ket">|11⟩</div>
                    <div class="binary">Binary: 3</div>
                    <div class="vector">[0,0,0,1]ᵀ</div>
                </div>
            </div>
            <div class="highlight">
                <p style="text-align:center;">|ab⟩ means qubit 1 is in state |a⟩ and qubit 2 is in state |b⟩</p>
            </div>
        </section>

        <section class="section">
            <h2>Tensor Product Visualization</h2>
            <p>When we apply gates to individual qubits, we use the tensor product to get the combined gate:</p>
            <div class="tensor-visual">
                <div>
                    <p style="color:#64ffda;text-align:center;margin-bottom:5px;">Gate on Q1</p>
                    <div class="matrix-box matrix-2x2">
                        <div class="cell">a</div><div class="cell">b</div>
                        <div class="cell">c</div><div class="cell">d</div>
                    </div>
                </div>
                <span class="op-symbol">⊗</span>
                <div>
                    <p style="color:#64ffda;text-align:center;margin-bottom:5px;">Gate on Q2</p>
                    <div class="matrix-box matrix-2x2">
                        <div class="cell">e</div><div class="cell">f</div>
                        <div class="cell">g</div><div class="cell">h</div>
                    </div>
                </div>
                <span class="op-symbol">=</span>
                <div>
                    <p style="color:#64ffda;text-align:center;margin-bottom:5px;">Combined 4×4</p>
                    <div class="matrix-box matrix-4x4">
                        <div class="cell">ae</div><div class="cell">af</div><div class="cell">be</div><div class="cell">bf</div>
                        <div class="cell">ag</div><div class="cell">ah</div><div class="cell">bg</div><div class="cell">bh</div>
                        <div class="cell">ce</div><div class="cell">cf</div><div class="cell">de</div><div class="cell">df</div>
                        <div class="cell">cg</div><div class="cell">ch</div><div class="cell">dg</div><div class="cell">dh</div>
                    </div>
                </div>
            </div>
        </section>

        <section class="section">
            <h2>Example: X ⊗ I (X on first qubit only)</h2>
            <div class="tensor-visual">
                <div>
                    <p style="color:#ff6b6b;text-align:center;margin-bottom:5px;">X Gate</p>
                    <div class="matrix-box matrix-2x2">
                        <div class="cell">0</div><div class="cell">1</div>
                        <div class="cell">1</div><div class="cell">0</div>
                    </div>
                </div>
                <span class="op-symbol">⊗</span>
                <div>
                    <p style="color:#888;text-align:center;margin-bottom:5px;">Identity</p>
                    <div class="matrix-box matrix-2x2">
                        <div class="cell">1</div><div class="cell">0</div>
                        <div class="cell">0</div><div class="cell">1</div>
                    </div>
                </div>
                <span class="op-symbol">=</span>
                <div>
                    <p style="color:#64ffda;text-align:center;margin-bottom:5px;">X ⊗ I</p>
                    <div class="matrix-box matrix-4x4">
                        <div class="cell">0</div><div class="cell">0</div><div class="cell">1</div><div class="cell">0</div>
                        <div class="cell">0</div><div class="cell">0</div><div class="cell">0</div><div class="cell">1</div>
                        <div class="cell">1</div><div class="cell">0</div><div class="cell">0</div><div class="cell">0</div>
                        <div class="cell">0</div><div class="cell">1</div><div class="cell">0</div><div class="cell">0</div>
                    </div>
                </div>
            </div>
            <p style="color:#888;text-align:center;margin-top:10px;">This flips the first qubit: |00⟩↔|10⟩, |01⟩↔|11⟩</p>
        </section>

        <section class="section">
            <h2>Interactive Two-Qubit State Explorer</h2>
            <div class="interactive-section">
                <div class="qubit-controls">
                    <div class="qubit-control">
                        <h4>Qubit 1</h4>
                        <div class="toggle-btns">
                            <button class="toggle-btn active" id="q1-0" onclick="setQubit(1,0)">|0⟩</button>
                            <button class="toggle-btn" id="q1-1" onclick="setQubit(1,1)">|1⟩</button>
                            <button class="toggle-btn" id="q1-plus" onclick="setQubit(1,'+')">|+⟩</button>
                        </div>
                    </div>
                    <div class="qubit-control">
                        <h4>Qubit 2</h4>
                        <div class="toggle-btns">
                            <button class="toggle-btn active" id="q2-0" onclick="setQubit(2,0)">|0⟩</button>
                            <button class="toggle-btn" id="q2-1" onclick="setQubit(2,1)">|1⟩</button>
                            <button class="toggle-btn" id="q2-plus" onclick="setQubit(2,'+')">|+⟩</button>
                        </div>
                    </div>
                </div>
                <div class="dual-bloch">
                    <div class="bloch-panel">
                        <h4>Qubit 1</h4>
                        <div id="bloch-1" class="mini-bloch"></div>
                        <div class="state-label" id="state-1">|0⟩</div>
                    </div>
                    <div class="bloch-panel">
                        <h4>Qubit 2</h4>
                        <div id="bloch-2" class="mini-bloch"></div>
                        <div class="state-label" id="state-2">|0⟩</div>
                    </div>
                </div>
                <div class="combined-state" id="combined-state">|ψ⟩ = |00⟩</div>
                <div class="amp-display" id="amp-display">
                    <div class="amp-item"><div class="ket">|00⟩</div><div class="bar"><div class="fill" style="height:100%"></div></div><div class="val">1.00</div></div>
                    <div class="amp-item"><div class="ket">|01⟩</div><div class="bar"><div class="fill" style="height:0%"></div></div><div class="val">0.00</div></div>
                    <div class="amp-item"><div class="ket">|10⟩</div><div class="bar"><div class="fill" style="height:0%"></div></div><div class="val">0.00</div></div>
                    <div class="amp-item"><div class="ket">|11⟩</div><div class="bar"><div class="fill" style="height:0%"></div></div><div class="val">0.00</div></div>
                </div>
            </div>
        </section>

        <section class="section">
            <div class="decision-guide">
                <h3>Multi-Qubit Gate Selection Guide</h3>
                <div class="decision-item">
                    <span class="goal">Apply gate to one qubit only:</span>
                    <span class="solution">Use <span class="gate">Gate ⊗ I</span> or <span class="gate">I ⊗ Gate</span></span>
                </div>
                <div class="decision-item">
                    <span class="goal">Apply same gate to both qubits:</span>
                    <span class="solution">Use <span class="gate">Gate ⊗ Gate</span> (e.g., H⊗H for superposition)</span>
                </div>
                <div class="decision-item">
                    <span class="goal">Create entanglement:</span>
                    <span class="solution">Use <span class="gate">CNOT</span> after H on control qubit</span>
                </div>
                <div class="decision-item">
                    <span class="goal">Conditional operation:</span>
                    <span class="solution">Use <span class="gate">Controlled gates</span> (CNOT, CZ, etc.)</span>
                </div>
                <div class="decision-item">
                    <span class="goal">Swap qubit states:</span>
                    <span class="solution">Use <span class="gate">SWAP gate</span> or 3 CNOTs</span>
                </div>
            </div>
        </section>

        <section class="section">
            <h2>State Space Growth</h2>
            <div class="highlight">
                <table class="gate-table">
                    <tr><th>Qubits</th><th>Basis States</th><th>State Vector Size</th><th>Gate Matrix Size</th></tr>
                    <tr><td>1</td><td>2</td><td>2</td><td>2×2</td></tr>
                    <tr><td>2</td><td>4</td><td>4</td><td>4×4</td></tr>
                    <tr><td>3</td><td>8</td><td>8</td><td>8×8</td></tr>
                    <tr><td>10</td><td>1,024</td><td>1,024</td><td>1024×1024</td></tr>
                    <tr><td>50</td><td>~10¹⁵</td><td>~10¹⁵</td><td>~10³⁰ elements!</td></tr>
                </table>
                <p style="text-align:center;margin-top:15px;color:#888;">This exponential growth is why quantum computers are hard to simulate classically!</p>
            </div>
        </section>

        <div class="nav-buttons">
            <a href="../06-rotation-gates/index.html" class="btn">Previous: Rotation Gates</a>
            <a href="../08-controlled-gates/index.html" class="btn btn-primary">Next: Controlled Gates</a>
        </div>
    </div>

    <script>
    let q1State = {theta: 0, phi: 0, label: '|0⟩'};
    let q2State = {theta: 0, phi: 0, label: '|0⟩'};
    let bloch1Arrow, bloch2Arrow;

    function createBloch(id) {
        const c = document.getElementById(id);
        if (!c) return null;
        const scene = new THREE.Scene();
        scene.background = new THREE.Color(0x050505);
        const camera = new THREE.PerspectiveCamera(50, c.clientWidth/c.clientHeight, 0.1, 1000);
        camera.position.set(1.8, 1.2, 1.8);
        const renderer = new THREE.WebGLRenderer({antialias:true});
        renderer.setSize(c.clientWidth, c.clientHeight);
        c.appendChild(renderer.domElement);
        const controls = new THREE.OrbitControls(camera, renderer.domElement);
        controls.enableDamping = true;
        controls.enableZoom = false;
        
        scene.add(new THREE.AmbientLight(0xffffff, 0.5));
        const light = new THREE.PointLight(0xffffff, 0.8);
        light.position.set(5,5,5);
        scene.add(light);
        
        scene.add(new THREE.Mesh(new THREE.SphereGeometry(1,24,24), new THREE.MeshPhongMaterial({color:0x64ffda,transparent:true,opacity:0.08})));
        scene.add(new THREE.Mesh(new THREE.SphereGeometry(1,12,12), new THREE.MeshBasicMaterial({color:0x64ffda,wireframe:true,transparent:true,opacity:0.1})));
        
        scene.add(new THREE.ArrowHelper(new THREE.Vector3(1,0,0), new THREE.Vector3(0,0,0), 1.1, 0xff6b6b, 0.06, 0.03));
        scene.add(new THREE.ArrowHelper(new THREE.Vector3(0,1,0), new THREE.Vector3(0,0,0), 1.1, 0x4ecdc4, 0.06, 0.03));
        scene.add(new THREE.ArrowHelper(new THREE.Vector3(0,0,1), new THREE.Vector3(0,0,0), 1.1, 0xffd93d, 0.06, 0.03));
        
        const arrow = new THREE.ArrowHelper(new THREE.Vector3(0,0,1), new THREE.Vector3(0,0,0), 1, 0xffffff, 0.1, 0.06);
        scene.add(arrow);
        
        function animate() {
            requestAnimationFrame(animate);
            controls.update();
            renderer.render(scene, camera);
        }
        animate();
        
        return arrow;
    }
    
    bloch1Arrow = createBloch('bloch-1');
    bloch2Arrow = createBloch('bloch-2');

    function setQubit(q, state) {
        let theta, phi, label;
        if(state === 0) { theta = 0; phi = 0; label = '|0⟩'; }
        else if(state === 1) { theta = Math.PI; phi = 0; label = '|1⟩'; }
        else if(state === '+') { theta = Math.PI/2; phi = 0; label = '|+⟩'; }
        
        if(q === 1) {
            q1State = {theta, phi, label};
            document.querySelectorAll('#q1-0,#q1-1,#q1-plus').forEach(b => b.classList.remove('active'));
            document.getElementById('q1-' + (state === '+' ? 'plus' : state)).classList.add('active');
            document.getElementById('state-1').textContent = label;
            const x = Math.sin(theta)*Math.cos(phi), y = Math.sin(theta)*Math.sin(phi), z = Math.cos(theta);
            bloch1Arrow.setDirection(new THREE.Vector3(x,y,z).normalize());
        } else {
            q2State = {theta, phi, label};
            document.querySelectorAll('#q2-0,#q2-1,#q2-plus').forEach(b => b.classList.remove('active'));
            document.getElementById('q2-' + (state === '+' ? 'plus' : state)).classList.add('active');
            document.getElementById('state-2').textContent = label;
            const x = Math.sin(theta)*Math.cos(phi), y = Math.sin(theta)*Math.sin(phi), z = Math.cos(theta);
            bloch2Arrow.setDirection(new THREE.Vector3(x,y,z).normalize());
        }
        updateCombinedState();
    }

    function updateCombinedState() {
        const a1_0 = Math.cos(q1State.theta/2), a1_1 = Math.sin(q1State.theta/2);
        const a2_0 = Math.cos(q2State.theta/2), a2_1 = Math.sin(q2State.theta/2);
        
        const amps = [
            a1_0 * a2_0,
            a1_0 * a2_1,
            a1_1 * a2_0,
            a1_1 * a2_1
        ];
        
        const labels = ['|00⟩', '|01⟩', '|10⟩', '|11⟩'];
        let stateStr = '|ψ⟩ = ';
        let terms = [];
        amps.forEach((a, i) => {
            if(Math.abs(a) > 0.01) {
                let coef = Math.abs(a) < 0.99 ? a.toFixed(2) : (a > 0 ? '' : '-');
                terms.push(coef + labels[i]);
            }
        });
        stateStr += terms.join(' + ').replace(/\+ -/g, '- ');
        document.getElementById('combined-state').textContent = stateStr;
        
        const ampDisplay = document.getElementById('amp-display');
        ampDisplay.innerHTML = labels.map((l, i) => `
            <div class="amp-item">
                <div class="ket">${l}</div>
                <div class="bar"><div class="fill" style="height:${Math.abs(amps[i])*100}%"></div></div>
                <div class="val">${Math.abs(amps[i]).toFixed(2)}</div>
            </div>
        `).join('');
    }

    updateCombinedState();
    </script>
</body>
</html>
