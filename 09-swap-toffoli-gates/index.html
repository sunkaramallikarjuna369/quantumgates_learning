<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SWAP & Toffoli Gates - Devin's Teaching Style</title>
    <link rel="stylesheet" href="../shared/styles.css">
    <style>
        .fourwh-box { background: linear-gradient(135deg, rgba(100,255,218,0.12), rgba(78,205,196,0.06)); border: 2px solid rgba(100,255,218,0.4); border-radius: 16px; padding: 25px; margin: 25px 0; }
        .fourwh-box h3 { color: #64ffda; margin-bottom: 20px; font-size: 1.4em; }
        .fourwh-item { background: rgba(0,0,0,0.4); border-radius: 12px; padding: 20px; margin: 15px 0; border-left: 5px solid; }
        .fourwh-item.what { border-color: #ff6b6b; }
        .fourwh-item.why { border-color: #ffd93d; }
        .fourwh-item.when { border-color: #4ecdc4; }
        .fourwh-item.where { border-color: #a855f7; }
        .fourwh-item.how { border-color: #64ffda; }
        .fourwh-item h4 { margin-bottom: 12px; font-size: 1.2em; }
        .fourwh-item.what h4 { color: #ff6b6b; }
        .fourwh-item.why h4 { color: #ffd93d; }
        .fourwh-item.when h4 { color: #4ecdc4; }
        .fourwh-item.where h4 { color: #a855f7; }
        .fourwh-item.how h4 { color: #64ffda; }
        .fourwh-item p, .fourwh-item li { color: #ccc; line-height: 1.7; }
        .prereq-box { background: linear-gradient(135deg, rgba(168,85,247,0.1), rgba(168,85,247,0.05)); border: 2px solid rgba(168,85,247,0.3); border-radius: 16px; padding: 25px; margin: 20px 0; }
        .prereq-box h3 { color: #a855f7; margin-bottom: 15px; }
        .prereq-item { background: rgba(0,0,0,0.3); border-radius: 10px; padding: 15px; margin: 12px 0; border-left: 4px solid #a855f7; }
        .prereq-item h4 { color: #c084fc; margin-bottom: 8px; }
        .matrix-derivation { background: rgba(255,215,0,0.08); border: 2px solid rgba(255,215,0,0.3); border-radius: 16px; padding: 25px; margin: 25px 0; }
        .matrix-derivation h3 { color: #ffd93d; margin-bottom: 20px; }
        .derivation-step { background: rgba(0,0,0,0.3); border-radius: 10px; padding: 20px; margin: 15px 0; }
        .derivation-step h4 { color: #4ecdc4; margin-bottom: 12px; }
        .derivation-step .explanation { color: #ccc; line-height: 1.6; }
        .derivation-step .formula { background: rgba(100,255,218,0.1); padding: 15px; border-radius: 8px; margin: 10px 0; font-family: monospace; font-size: 1.1em; color: #64ffda; text-align: center; }
        .matrix-visual { display: flex; align-items: center; justify-content: center; gap: 15px; margin: 20px 0; flex-wrap: wrap; }
        .matrix-box { display: inline-grid; gap: 3px; background: rgba(0,0,0,0.5); padding: 10px; border-radius: 10px; border: 2px solid rgba(100,255,218,0.3); }
        .matrix-box.m4 { grid-template-columns: repeat(4, 35px); }
        .matrix-box.m8 { grid-template-columns: repeat(8, 28px); }
        .matrix-box .cell { height: 28px; display: flex; align-items: center; justify-content: center; background: rgba(100,255,218,0.15); color: #fff; font-size: 11px; border-radius: 4px; font-family: monospace; }
        .key-insight { background: linear-gradient(135deg, rgba(255,107,107,0.1), rgba(255,107,107,0.05)); border: 2px solid rgba(255,107,107,0.3); border-radius: 12px; padding: 20px; margin: 20px 0; }
        .key-insight h4 { color: #ff6b6b; margin-bottom: 10px; }
        .key-insight p { color: #ccc; line-height: 1.6; }
        .gate-card { background: rgba(0,0,0,0.4); border-radius: 16px; padding: 25px; margin: 25px 0; border: 2px solid; }
        .gate-card.swap-card { border-color: rgba(78,205,196,0.5); }
        .gate-card.toffoli-card { border-color: rgba(168,85,247,0.5); }
        .gate-card h3 { margin-bottom: 20px; }
        .gate-card.swap-card h3 { color: #4ecdc4; }
        .gate-card.toffoli-card h3 { color: #a855f7; }
        .simulator { background: rgba(0,0,0,0.5); border-radius: 16px; padding: 25px; margin: 25px 0; border: 2px solid rgba(100,255,218,0.3); }
        .simulator h3 { color: #64ffda; margin-bottom: 20px; }
        .qubit-row { display: flex; align-items: center; gap: 20px; margin: 15px 0; padding: 15px; background: rgba(0,0,0,0.3); border-radius: 10px; }
        .qubit-label { width: 80px; color: #a855f7; font-weight: bold; }
        .qubit-state { font-family: monospace; font-size: 1.3em; color: #64ffda; min-width: 50px; }
        .qubit-toggle { padding: 10px 20px; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; transition: all 0.3s; }
        .qubit-toggle.off { background: rgba(100,255,218,0.2); color: #64ffda; }
        .qubit-toggle.on { background: #64ffda; color: #000; }
        .gate-btn { padding: 12px 25px; border: none; border-radius: 10px; font-size: 15px; cursor: pointer; font-weight: bold; transition: all 0.3s; margin: 8px; }
        .gate-btn:hover { transform: scale(1.05); }
        .gate-btn.swap { background: linear-gradient(135deg, #4ecdc4, #6ee7de); color: #000; }
        .gate-btn.toffoli { background: linear-gradient(135deg, #a855f7, #c084fc); color: #fff; }
        .gate-btn.reset { background: linear-gradient(135deg, #666, #888); color: #fff; }
        .result-display { text-align: center; margin-top: 20px; padding: 20px; background: rgba(100,255,218,0.1); border-radius: 10px; }
        .result-display .state { font-size: 1.4em; color: #64ffda; font-family: monospace; }
        .result-display .info { color: #888; margin-top: 10px; }
        .truth-table { width: 100%; border-collapse: collapse; margin: 20px 0; font-size: 0.9em; }
        .truth-table th, .truth-table td { padding: 10px; text-align: center; border: 1px solid rgba(100,255,218,0.3); }
        .truth-table th { background: rgba(100,255,218,0.2); color: #64ffda; }
        .truth-table td { background: rgba(0,0,0,0.3); color: #ccc; font-family: monospace; }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>SWAP & Toffoli Gates</h1>
            <p class="subtitle">Exchanging Qubits and Universal Classical Computation</p>
        </header>

        <section class="section">
            <div class="prereq-box">
                <h3>Prerequisites</h3>
                <div class="prereq-item">
                    <h4>1. CNOT Gate</h4>
                    <p>SWAP is built from 3 CNOTs. Toffoli is a doubly-controlled NOT. Understanding CNOT is essential for both gates.</p>
                </div>
                <div class="prereq-item">
                    <h4>2. Reversible Computing</h4>
                    <p>Classical AND/OR gates lose information (can't recover inputs from output). Toffoli is a reversible AND gate - it preserves all information, enabling reversible classical computing.</p>
                </div>
                <div class="prereq-item">
                    <h4>3. Universal Gate Sets</h4>
                    <p>Toffoli alone is universal for classical reversible computing. Combined with H, it's universal for quantum computing. SWAP enables qubit routing in circuits.</p>
                </div>
            </div>
        </section>

        <div class="gate-card swap-card">
            <h3>SWAP Gate</h3>
            <div class="fourwh-box" style="margin-top:0;">
                <div class="fourwh-item what">
                    <h4>WHAT does SWAP do?</h4>
                    <p>SWAP exchanges the states of two qubits. SWAP|ab⟩ = |ba⟩. It's symmetric and self-inverse: SWAP² = I.</p>
                </div>
                <div class="fourwh-item why">
                    <h4>WHY is the SWAP matrix a permutation?</h4>
                    <p><strong>Derivation:</strong> SWAP|00⟩=|00⟩, SWAP|01⟩=|10⟩, SWAP|10⟩=|01⟩, SWAP|11⟩=|11⟩</p>
                    <div class="matrix-visual">
                        <span style="color:#888;">SWAP = </span>
                        <div class="matrix-box m4" style="border-color:rgba(78,205,196,0.5);">
                            <div class="cell" style="background:rgba(78,205,196,0.2);">1</div><div class="cell" style="background:rgba(78,205,196,0.2);">0</div><div class="cell" style="background:rgba(78,205,196,0.2);">0</div><div class="cell" style="background:rgba(78,205,196,0.2);">0</div>
                            <div class="cell" style="background:rgba(78,205,196,0.2);">0</div><div class="cell" style="background:rgba(78,205,196,0.2);">0</div><div class="cell" style="background:rgba(78,205,196,0.2);">1</div><div class="cell" style="background:rgba(78,205,196,0.2);">0</div>
                            <div class="cell" style="background:rgba(78,205,196,0.2);">0</div><div class="cell" style="background:rgba(78,205,196,0.2);">1</div><div class="cell" style="background:rgba(78,205,196,0.2);">0</div><div class="cell" style="background:rgba(78,205,196,0.2);">0</div>
                            <div class="cell" style="background:rgba(78,205,196,0.2);">0</div><div class="cell" style="background:rgba(78,205,196,0.2);">0</div><div class="cell" style="background:rgba(78,205,196,0.2);">0</div><div class="cell" style="background:rgba(78,205,196,0.2);">1</div>
                        </div>
                    </div>
                </div>
                <div class="fourwh-item how">
                    <h4>HOW to build SWAP from CNOTs?</h4>
                    <div class="formula">SWAP = CNOT₁₂ · CNOT₂₁ · CNOT₁₂</div>
                    <p class="explanation">Three CNOTs with alternating control/target implement SWAP. This is the standard decomposition used in hardware.</p>
                </div>
            </div>
            <div class="key-insight">
                <h4>Key Insight: SWAP preserves entanglement</h4>
                <p>SWAP doesn't create or destroy entanglement - it just moves it around. If qubits 1 and 2 are entangled with qubit 3, after SWAP(1,2), qubits 2 and 1 have swapped their entanglement relationships.</p>
            </div>
        </div>

        <section class="section">
            <div class="simulator">
                <h3>SWAP Simulator</h3>
                <div class="qubit-row">
                    <span class="qubit-label">Qubit A:</span>
                    <span class="qubit-state" id="swap-a">|0⟩</span>
                    <button class="qubit-toggle off" id="swap-a-toggle" onclick="toggleSwap('a')">Toggle</button>
                </div>
                <div class="qubit-row">
                    <span class="qubit-label">Qubit B:</span>
                    <span class="qubit-state" id="swap-b">|0⟩</span>
                    <button class="qubit-toggle off" id="swap-b-toggle" onclick="toggleSwap('b')">Toggle</button>
                </div>
                <div style="text-align:center;margin-top:20px;">
                    <button class="gate-btn swap" onclick="applySwap()">Apply SWAP</button>
                    <button class="gate-btn reset" onclick="resetSwap()">Reset</button>
                </div>
                <div class="result-display">
                    <div class="state" id="swap-result">|00⟩</div>
                </div>
            </div>
        </section>

        <div class="gate-card toffoli-card">
            <h3>Toffoli Gate (CCNOT)</h3>
            <div class="fourwh-box" style="margin-top:0;">
                <div class="fourwh-item what">
                    <h4>WHAT does Toffoli do?</h4>
                    <p>Toffoli is a doubly-controlled NOT: it flips the target qubit ONLY when BOTH control qubits are |1⟩. Toffoli|abc⟩ = |ab, c⊕(a·b)⟩. It's the quantum AND gate!</p>
                </div>
                <div class="fourwh-item why">
                    <h4>WHY is Toffoli important?</h4>
                    <p>Toffoli is universal for classical reversible computing - any classical circuit can be built from Toffoli gates. Combined with Hadamard, it's universal for quantum computing. It's also used in quantum arithmetic and error correction.</p>
                </div>
                <div class="fourwh-item when">
                    <h4>WHEN to use Toffoli?</h4>
                    <p><strong>Arithmetic:</strong> Building adders, multipliers. <strong>Oracles:</strong> Implementing classical functions reversibly. <strong>Error correction:</strong> Syndrome extraction. <strong>Grover's algorithm:</strong> Multi-controlled operations in oracles.</p>
                </div>
                <div class="fourwh-item how">
                    <h4>HOW does the Toffoli matrix work?</h4>
                    <p>8×8 matrix (3 qubits = 2³ = 8 basis states). Only |110⟩↔|111⟩ are swapped; all others unchanged.</p>
                    <div class="matrix-visual">
                        <span style="color:#888;font-size:0.9em;">Toffoli = diag(1,1,1,1,1,1) ⊕ </span>
                        <div class="matrix-box" style="grid-template-columns:repeat(2,30px);border-color:rgba(168,85,247,0.5);">
                            <div class="cell" style="background:rgba(168,85,247,0.2);">0</div><div class="cell" style="background:rgba(168,85,247,0.2);">1</div>
                            <div class="cell" style="background:rgba(168,85,247,0.2);">1</div><div class="cell" style="background:rgba(168,85,247,0.2);">0</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <h4 style="color:#a855f7;margin-top:20px;">Toffoli Truth Table</h4>
            <table class="truth-table">
                <tr><th>Input</th><th>C1</th><th>C2</th><th>T</th><th>Output</th><th>Action</th></tr>
                <tr><td>|000⟩</td><td>0</td><td>0</td><td>0</td><td>|000⟩</td><td>No flip</td></tr>
                <tr><td>|001⟩</td><td>0</td><td>0</td><td>1</td><td>|001⟩</td><td>No flip</td></tr>
                <tr><td>|010⟩</td><td>0</td><td>1</td><td>0</td><td>|010⟩</td><td>No flip</td></tr>
                <tr><td>|011⟩</td><td>0</td><td>1</td><td>1</td><td>|011⟩</td><td>No flip</td></tr>
                <tr><td>|100⟩</td><td>1</td><td>0</td><td>0</td><td>|100⟩</td><td>No flip</td></tr>
                <tr><td>|101⟩</td><td>1</td><td>0</td><td>1</td><td>|101⟩</td><td>No flip</td></tr>
                <tr><td>|110⟩</td><td>1</td><td>1</td><td>0</td><td>|111⟩</td><td>FLIP!</td></tr>
                <tr><td>|111⟩</td><td>1</td><td>1</td><td>1</td><td>|110⟩</td><td>FLIP!</td></tr>
            </table>
            
            <div class="key-insight">
                <h4>Key Insight: Toffoli computes AND reversibly</h4>
                <p>If target starts as |0⟩: Toffoli|ab0⟩ = |ab, a·b⟩. The target becomes the AND of the controls! This is reversible because we keep the inputs. Classical AND loses information; Toffoli preserves it.</p>
            </div>
        </div>

        <section class="section">
            <div class="simulator">
                <h3>Toffoli Simulator</h3>
                <div class="qubit-row">
                    <span class="qubit-label">Control 1:</span>
                    <span class="qubit-state" id="tof-c1">|0⟩</span>
                    <button class="qubit-toggle off" id="tof-c1-toggle" onclick="toggleTof('c1')">Toggle</button>
                </div>
                <div class="qubit-row">
                    <span class="qubit-label">Control 2:</span>
                    <span class="qubit-state" id="tof-c2">|0⟩</span>
                    <button class="qubit-toggle off" id="tof-c2-toggle" onclick="toggleTof('c2')">Toggle</button>
                </div>
                <div class="qubit-row">
                    <span class="qubit-label">Target:</span>
                    <span class="qubit-state" id="tof-t">|0⟩</span>
                    <button class="qubit-toggle off" id="tof-t-toggle" onclick="toggleTof('t')">Toggle</button>
                </div>
                <div style="text-align:center;margin-top:20px;">
                    <button class="gate-btn toffoli" onclick="applyToffoli()">Apply Toffoli</button>
                    <button class="gate-btn reset" onclick="resetToffoli()">Reset</button>
                </div>
                <div class="result-display">
                    <div class="state" id="tof-result">|000⟩</div>
                    <div class="info" id="tof-info">Both controls must be |1⟩ to flip target</div>
                </div>
            </div>
        </section>

        <section class="section">
            <div class="matrix-derivation">
                <h3>Decomposing Toffoli into Basic Gates</h3>
                <div class="derivation-step">
                    <h4>Toffoli from CNOTs and T gates</h4>
                    <p class="explanation">Toffoli can be decomposed into 6 CNOTs and several single-qubit gates (H, T, T†). This is important because hardware typically only implements 1- and 2-qubit gates natively.</p>
                    <div class="formula">Toffoli = (H₃)(CNOT₂₃)(T†₃)(CNOT₁₃)(T₃)(CNOT₂₃)(T†₃)(CNOT₁₃)(T₂T₃)(CNOT₁₂)(T₁T†₂)(CNOT₁₂)(H₃)</div>
                </div>
            </div>
        </section>

        <div class="nav-buttons">
            <a href="../08-controlled-gates/index.html" class="btn">Previous: Controlled Gates</a>
            <a href="../10-unitary-reversibility/index.html" class="btn btn-primary">Next: Unitary & Reversibility</a>
        </div>
    </div>

    <script>
    let swapA = 0, swapB = 0;
    let tofC1 = 0, tofC2 = 0, tofT = 0;
    
    function updateSwapDisplay() {
        document.getElementById('swap-a').textContent = '|' + swapA + '⟩';
        document.getElementById('swap-b').textContent = '|' + swapB + '⟩';
        document.getElementById('swap-a-toggle').className = 'qubit-toggle ' + (swapA ? 'on' : 'off');
        document.getElementById('swap-b-toggle').className = 'qubit-toggle ' + (swapB ? 'on' : 'off');
        document.getElementById('swap-result').textContent = '|' + swapA + swapB + '⟩';
    }
    
    function toggleSwap(q) {
        if (q === 'a') swapA = 1 - swapA;
        else swapB = 1 - swapB;
        updateSwapDisplay();
    }
    
    function applySwap() {
        var temp = swapA;
        swapA = swapB;
        swapB = temp;
        updateSwapDisplay();
    }
    
    function resetSwap() {
        swapA = 0; swapB = 0;
        updateSwapDisplay();
    }
    
    function updateTofDisplay() {
        document.getElementById('tof-c1').textContent = '|' + tofC1 + '⟩';
        document.getElementById('tof-c2').textContent = '|' + tofC2 + '⟩';
        document.getElementById('tof-t').textContent = '|' + tofT + '⟩';
        document.getElementById('tof-c1-toggle').className = 'qubit-toggle ' + (tofC1 ? 'on' : 'off');
        document.getElementById('tof-c2-toggle').className = 'qubit-toggle ' + (tofC2 ? 'on' : 'off');
        document.getElementById('tof-t-toggle').className = 'qubit-toggle ' + (tofT ? 'on' : 'off');
        document.getElementById('tof-result').textContent = '|' + tofC1 + tofC2 + tofT + '⟩';
        var info = (tofC1 && tofC2) ? 'Both controls are |1⟩ - target will flip!' : 'Controls not both |1⟩ - no flip';
        document.getElementById('tof-info').textContent = info;
    }
    
    function toggleTof(q) {
        if (q === 'c1') tofC1 = 1 - tofC1;
        else if (q === 'c2') tofC2 = 1 - tofC2;
        else tofT = 1 - tofT;
        updateTofDisplay();
    }
    
    function applyToffoli() {
        if (tofC1 && tofC2) tofT = 1 - tofT;
        updateTofDisplay();
    }
    
    function resetToffoli() {
        tofC1 = 0; tofC2 = 0; tofT = 0;
        updateTofDisplay();
    }
    
    window.addEventListener('load', function() { updateSwapDisplay(); updateTofDisplay(); });
    </script>
</body>
</html>
